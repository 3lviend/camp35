(function(){"use strict";var e=typeof window!="undefined"?window:global;if(typeof e.require=="function")return;var t={},n={},r=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var n=[],r,i;/^\.\.?(\/|$)/.test(t)?r=[e,t].join("/").split("/"):r=t.split("/");for(var s=0,o=r.length;s<o;s++)i=r[s],i===".."?n.pop():i!=="."&&i!==""&&n.push(i);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},o=function(t){return function(n){var r=s(t),o=i(r,n);return e.require(o)}},u=function(e,t){var r={id:e,exports:{}};t(r.exports,o(e),r);var i=n[e]=r.exports;return i},a=function(e){var s=i(e,".");if(r(n,s))return n[s];if(r(t,s))return u(s,t[s]);var o=i(s,"./index");if(r(n,o))return n[o];if(r(t,o))return u(o,t[o]);throw new Error('Cannot find module "'+e+'"')},f=function(e){for(var n in e)r(e,n)&&(t[n]=e[n])};e.require=a,e.require.define=f,e.require.brunch=!0})(),window.require.define({application:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y;h=t("routers/router"),l=t("models/role"),c=t("collections/roles"),d=t("views/navigation/top_bar"),p=t("views/admin/switch_role"),f=t("views/reports"),u=t("views/auth/login"),i=t("views/calendar"),o=t("views/entries/new"),s=t("views/entries/edit"),v=t("views/work_day"),a=t("lib/modal_window.js"),n.exports=r=function(){function e(){var e=this;$(function(){return e.initialize(),Backbone.history.start({pushState:!0})})}return e.prototype.initialize=function(){return this.current_role=new l,this.current_role.url="/roles/current.json",this.current_role.fetch(),this.rolesToSwitch=new c,this.rolesToSwitch.url="/roles/others.json",this.rolesToReport=new c,this.rolesToReport.url="/roles/reportable.json",this.router=new h,this.topBarView=new d({role:this.current_role}),this.switchRoleView=new p({other_roles:this.rolesToSwitch}),this.reportsView=new f({roles:this.rolesToReport}),this.loginView=new u,this.modal=new a("#modal"),$(document).foundationTopBar()},e}(),window.app=new r,m=function(){if(!window.spin)return window.spin=new Spinner({lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:"#fff",speed:1,trail:58,shadow:!0,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"})},g=function(){return window.spin||m(),$("li.name a").css("visibility","hidden"),window.spin.spin($("li.name")[0])},y=function(){return $("li.name a").css("visibility","visible"),window.spin.stop()},$.ajaxSetup({beforeSend:g,complete:y,statusCode:{401:function(){return $("#today, #new_entry, #logout, #this_month").hide(),window.app.router.navigate("/#login",{trigger:!0})},403:function(){return window.app.router.navigate("/#denied",{trigger:!0}),$("#today, #new_entry, #logout, #this_month").hide()}}}),$(document).ajaxStop(y),$(document).ajaxStart(function(){return g()}),$(document).oneTime(200,function(){return humane.timeout=1e3})}}),window.require.define({"collections/duration_kinds":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("models/duration_kind"),n.exports=i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=r,t.prototype.url="/work_charts//duration_kinds.json",t}(Backbone.Collection)}}),window.require.define({"collections/roles":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("../models/role"),n.exports=i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=r,t}(Backbone.Collection)}}),window.require.define({"collections/work_charts":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("models/work_chart"),n.exports=i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=r,t.prototype.url="/work_charts",t}(Backbone.Collection)}}),window.require.define({"collections/work_days":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("../models/work_day"),n.exports=i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=r,t.prototype.url="/work_days/0",t}(Backbone.Collection)}}),window.require.define({"collections/work_entries":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};i=t("../models/work_entry"),n.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=i,t.prototype.url="/work_entries",t}(Backbone.Collection)}}),window.require.define({"collections/work_months":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("../models/work_month"),n.exports=i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.model=r,t.prototype.url="/work_months",t}(Backbone.Collection)}}),window.require.define({"lib/backbone_extensions.js":function(e,t,n){Backbone.History.prototype.refresh=function(){return Backbone.history.fragment=null,Backbone.history.navigate(document.location.hash,!0)}}}),window.require.define({"lib/font_helper.js":function(e,t,n){TimesheetApp.Helpers.FontHelper=function(){function e(){}return e.get_string_width=function(e,t){var n,r;return n=$("<span>"+t+"</span>"),$(e).append(n),r=n[0].offsetWidth,n.remove(),r},e}()}}),window.require.define({"lib/modal_window.js":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}};t("lib/window_extensions.js"),n.exports=r=function(){function e(e){this.show=i(this.show,this),this.selector=e}return e.prototype.show=function(e){return e==null&&(e={}),e.content&&$(this.selector).html(e.content),$(this.selector).reveal({closed:e.closed}),window.scroll_top(),$("body").off("keyup.reveal")},e}()}}),window.require.define({"lib/number_extensions.js":function(e,t,n){Number.prototype.format_money=function(){var e,t;return t=Math.floor(this),e=this*100%100,"$"+t+"."+e.toString().pad(2)}}}),window.require.define({"lib/string_extensions.js":function(e,t,n){var r;r=t("lib/time_interval.js"),String.prototype.format_interval=function(){return this.to_interval().to_s("decimal")},String.prototype.to_interval=function(){var e,t,n,i;return n=function(){if(/^\d{1,9}:\d{1,2}(:\d{1,2}){0,1}$/.test(this))return":";if(/^\d{1,9}h\s\d{1,2}m$/.test(this))return" ";throw"Unsupported time interval string: "+this}.call(this),i=this.split(n),e=i[0],t=i[1],new r(parseInt(e,10),parseInt(t,10))},String.prototype.pad=function(e){var t,n;return t=parseInt(this,10),n=this.length>e?this.length:e,String(Array(e).join("0")+t).slice(-1*n)},String.prototype.pagedown=function(){var e;return e=Markdown.getSanitizingConverter(),e.makeHtml(this)}}}),window.require.define({"lib/table_helper.js":function(e,t,n){TimesheetApp.Helpers.TableHelper=function(){function e(){}return e.align_interval=function(e){return this.align_interval_to(e,e)},e.align_interval_to=function(e,t){var n,r,i,s,o;if($(t).attr("data-aligned")==="true")return;o=$(t).text().split("."),r=o[0],i=o[1];if(i.length===2)return;return s=TimesheetApp.Helpers.FontHelper.get_string_width(e,"0"),n=parseInt($(t).css("padding-right"),10),$(t).css("padding-right",n+s),$(t).attr("data-aligned",!0)},e}()}}),window.require.define({"lib/time_interval.js":function(e,t,n){var r;n.exports=r=function(){function e(e,t){this.hours=e,this.minutes=t}return e.prototype.to_s=function(e){var t;switch(e){case"decimal":return t=(""+this.minutes*100/60).pad(2),""+this.hours+"."+t;default:throw"Unrecognized format: "+e}},e}()}}),window.require.define({"lib/window_extensions.js":function(e,t,n){Window.prototype.scroll_top=function(){return $("html, body").animate({scrollTop:0},"slow")}}}),window.require.define({"models/collection":function(e,t,n){var r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.model=t("./model"),n}(Backbone.Collection)}}),window.require.define({"models/duration_kind":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return this.url=i(this.url,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.url=function(){return"/work_charts//duration_kinds.json"},t}(Backbone.Model)}}),window.require.define({"models/model":function(e,t,n){var r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,e),t}(Backbone.Model)}}),window.require.define({"models/role":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return this.assume_async=i(this.assume_async,this),this.assumed_other=i(this.assumed_other,this),this.as_label=i(this.as_label,this),this.user_name=i(this.user_name,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.defaults={can_switch_roles:!1},t.prototype.user_name=function(){return this.get("display_label").split(":")[1]},t.prototype.as_label=function(){if(this.assumed_other())return this.get("as").split(":")[1]},t.prototype.assumed_other=function(){return this.get("as")!==void 0&&this.get("as")!==null},t.prototype.assume_async=function(e){var t=this;return $.ajax({url:"/roles/assume.json",type:"POST",data:{email:this.get("email")},success:function(t){if(e.success)return e.success(t)},error:function(t,n,r){if(e.error)return e.error(r)}})},t}(Backbone.Model)}}),window.require.define({"models/work_chart":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return this.url=i(this.url,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.url=function(){return"/work_charts/"+this.id+".json"},t}(Backbone.Model)}}),window.require.define({"models/work_day":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return this.href=i(this.href,this),this.week_of_date=i(this.week_of_date,this),this.date_class=i(this.date_class,this),this.status_class=i(this.status_class,this),this.day=i(this.day,this),this.nonbillable_time_string=i(this.nonbillable_time_string,this),this.billable_time_string=i(this.billable_time_string,this),this.time_string=i(this.time_string,this),this.in_future=i(this.in_future,this),this.date_string=i(this.date_string,this),this.data_url=i(this.data_url,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.data_url=function(){var e;return e=moment.utc(new Date(this.get("date"))),"#entries/"+e.year()+"/"+(e.month()+1)+"/"+e.date()},t.prototype.date_string=function(){var e;return e=moment.utc(new Date(this.get("date"))),""+e.format("YYYY-MM-DD, dddd")},t.prototype.in_future=function(){var e,t;return e=moment(this.get("date")),t=moment(new Date),e.year()>t.year()?!0:e.year()<t.year()?!1:e.month()>t.month()?!0:e.month()<t.month()?!1:e.date()>t.date()?!0:!1},t.prototype.time_string=function(){var e;return this.get("time")?this.get("time").format_interval():(e=moment.utc(this.get("date")),e.day()===0||e.day()===6?"":"0h 0m".format_interval())},t.prototype.billable_time_string=function(){var e;return this.get("billable_time")?this.get("billable_time").format_interval():(e=moment.utc(this.get("date")),e.day()===0||e.day()===6?"":"0h 0m".format_interval())},t.prototype.nonbillable_time_string=function(){var e;return this.get("nonbillable_time")?this.get("nonbillable_time").format_interval():(e=moment.utc(this.get("date")),e.day()===0||e.day()===6?"":"0h 0m".format_interval())},t.prototype.day_name=function(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday"}},t.prototype.day=function(){return moment(this.get("date")).date()},t.prototype.status_class=function(){var e,t;return this.get("has_zero")?"status-has-zero":(e=moment(this.get("date")),t=moment(new Date),e.year()===t.year()&&e.month()===t.month()&&e.date()===t.date()?"status-today":e.diff(moment(new Date))>0||e.day()===6||e.day()===0?parseInt(this.get("time").split(":")[0],10)>0?"status-ok":"status-notyet":parseInt(this.get("time").split(":")[0],10)<8?"status-little":"status-ok")},t.prototype.date_class=function(e,t){var n,r;return n=moment(this.get("date")),r=moment(new Date),"day-"+n.day()+" week-"+this.week_of_date(n,e,t)+" "+(n.year()===r.year()&&n.month()===r.month()&&n.date()===r.date()?"today":void 0)+" "+(n.day()===0||n.day()===6?"weekend":void 0)+" "+(n.month()+1!==t?"out-of-month":void 0)+" "+this.status_class()},t.prototype.week_of_date=function(e,t,n){var r,i,s;return r=parseInt(n),i=parseInt(t),e.month()+1<r&&e.year()===i||e.year()<i?1:e.month()+1>r||t<e.year()?(s=moment([e.year(),e.month(),1]),s.subtract("months",1),s.endOf("month"),Math.ceil((s.date()+moment(s).date(1).day())/7)):Math.ceil((e.date()+moment(e).date(1).day())/7)},t.prototype.href=function(){var e;return e=moment.utc(this.get("date")),"/#entries/"+e.year()+"/"+(e.month()+1)+"/"+e.date()},t}(Backbone.Model)}}),window.require.define({"models/work_entry":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t("lib/number_extensions.js"),n.exports=r=function(e){function t(){return this.delete_async=i(this.delete_async,this),this.front_url=i(this.front_url,this),this.fee_not_empty=i(this.fee_not_empty,this),this.fee_total_string=i(this.fee_total_string,this),this.time_string=i(this.time_string,this),this.nonbillable_minutes=i(this.nonbillable_minutes,this),this.nonbillable_hours=i(this.nonbillable_hours,this),this.billable_minutes=i(this.billable_minutes,this),this.billable_hours=i(this.billable_hours,this),this.minutes=i(this.minutes,this),this.hours=i(this.hours,this),this.middle_labels=i(this.middle_labels,this),this.last_label=i(this.last_label,this),this.chart_has_many_labels=i(this.chart_has_many_labels,this),this.top_label=i(this.top_label,this),this.url=i(this.url,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.defaults={work_chart_id:-1,work_entry_fees:[],description:"",work_entry_durations:[{duration:"00:00:00"}]},t.prototype.url=function(){return"/work_entries/"+this.id+".json"},t.prototype.top_label=function(){return _.first(_.rest(this.get("work_chart_label_parts")))},t.prototype.chart_has_many_labels=function(){return this.get("work_chart_label_parts").length>2},t.prototype.last_label=function(){return _.last(this.get("work_chart_label_parts"))},t.prototype.middle_labels=function(){return _.rest(_.rest(_.initial(this.get("work_chart_label_parts"))))},t.prototype.hours=function(){return this.get("total_duration").split(":")[0]},t.prototype.minutes=function(){return this.get("total_duration").split(":")[1]},t.prototype.billable_hours=function(){return parseInt(this.get("total_billable").split(":")[0],10)},t.prototype.billable_minutes=function(){return parseInt(this.get("total_billable").split(":")[1],10)},t.prototype.nonbillable_hours=function(){return parseInt(this.get("total_nonbillable").split(":")[0],10)},t.prototype.nonbillable_minutes=function(){return parseInt(this.get("total_nonbillable").split(":")[1],10)},t.prototype.time_string=function(){return this.get("total_duration").format_interval()},t.prototype.fee_total_string=function(){return this.get("fee_total").format_money()},t.prototype.fee_not_empty=function(){return this.get("fee_total")>0},t.prototype.front_url=function(){return"/#entry/"+this.get("id")},t.prototype.delete_async=function(e){var t;return e==null&&(e={}),t=moment(this.get("date_performed")),$.ajax({url:"/work_day_entries/"+t.year()+"/"+(t.month()+1)+"/"+t.date()+"/work_entries/"+this.get("id"),type:"DELETE",success:e.success,error:function(t,n,r){return e.error(r)}})},t}(Backbone.Model)}}),window.require.define({"models/work_month":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function t(){return this.month_class=i(this.month_class,this),this.front_url=i(this.front_url,this),this.month_year_string=i(this.month_year_string,this),this.nonbillable_string=i(this.nonbillable_string,this),this.billable_string=i(this.billable_string,this),this.total_string=i(this.total_string,this),this.available_string=i(this.available_string,this),t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.defaults={year:2012,month:11,available:160,billable_total:"80h 0m",nonbillable_total:"80h 0m",total:"160h 0m"},t.prototype.available_string=function(){return(""+this.get("available")+"h 0m").format_interval()},t.prototype.total_string=function(){return this.get("total").format_interval()},t.prototype.billable_string=function(){return this.get("billable_total").format_interval()},t.prototype.nonbillable_string=function(){return this.get("nonbillable_total").format_interval()},t.prototype.month_year_string=function(){return moment.utc([this.get("year"),this.get("month")-1,1]).format("MMMM YYYY")},t.prototype.front_url=function(){return"/#calendar/"+this.get("year")+"/"+this.get("month")},t.prototype.month_class=function(){var e,t;return e=moment(),this.get("month")>e.month()+1?"month-notyet":this.get("month")===e.month()+1?"month-current":(t=parseInt(this.get("total").split(" ")[0]),t>=this.get("available")?"month-ok":"month-little")},t}(Backbone.Model)}}),window.require.define({"routers/router":function(e,t,n){var r,i,s,o,u,a,f,l,c,h={}.hasOwnProperty,p=function(e,t){function r(){this.constructor=e}for(var n in t)h.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};c=t("collections/work_months"),a=t("collections/work_days"),f=t("collections/work_entries"),l=t("models/work_entry"),r=t("views/calendar"),s=t("views/entries/new"),i=t("views/entries/edit"),u=t("views/work_day"),n.exports=o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}var t=this;return p(n,e),n.prototype.routes={"":"root",login:"login","calendar/:year/:month":"home","entry/:id":"edit_entry","entries/:year/:month/:day/new":"new_entry","work_days/:weeks_from_now":"work_days","entries/:year/:month/:day":"work_day",reports:"reports"},n.prototype.redirect=function(){return this.navigate("")},n.prototype.initialize=function(){var e=this;return this.on("admin:assume-other",function(){return e.current_role=app.current_role,e.current_role.fetch(),app.rolesToSwitch.fetch()}),this.modal=app.modal,this.navigate("/#",{trigger:!0})},n.prototype.before={"^((?!login).)*$":function(){return this.render_navigation(),app.current_role.fetch()},login:function(){return $(".top-bar").html("")}},n.prototype.render_navigation=function(){return app.topBarView.render()},n.prototype.reports=function(){var e=this;return app.rolesToReport.fetch(),$(window).oneTime(100,function(){return app.reportsView.render()})},n.prototype.login=function(){var e=this;return $(window).oneTime(100,function(){return app.loginView.render()})},n.prototype.root=function(){var e;if(window.location.pathname!=="/users/sign_in")return e=moment(new Date),this.navigate("/#calendar/"+e.year()+"/"+(e.month()+1),{trigger:!0})},n.prototype.home=function(e,t){var n,i,s,o,u;return s=new c,i=new a,i.url="/work_days/calendar/"+e+"/"+t+".json",o=moment.utc([parseInt(e,10),parseInt(t,10)-1,1]),n=moment.utc(o).subtract("months",5),s.url="/work_months/"+n.format("YYYY-MM-01")+"/"+o.format("YYYY-MM-01")+".json",u=new r({collection:i,year:e,month:t,months:s}),i.fetch(),s.fetch()},n.prototype.new_entry=function(e,t,n){var r,i,o=this;return n=moment.utc([e,t-1,n]).format("YYYY-MM-DD"),r=new l({date_performed:n}),r.set("work_entry_durations",[{duration:"00:00:00"}]),i=new s({model:r}),$(window).oneTime(100,function(){return i.render()})},n.prototype.edit_entry=function(e){var t,n;return t=new l({id:e}),n=new i({model:t,charts:this.work_charts}),t.fetch()},n.prototype.work_days=function(e){var t,n;return t=new TimesheetApp.Collections.WorkDaysCollection,n=new TimesheetApp.Views.WorkDays.IndexView({collection:t,weeks_from_now:e}),t.url="/work_days/"+e+".json",t.fetch()},n.prototype.work_day=function(e,t,n){var r,i;return console.info("Work day"),r=new f,i=new u({collection:r,year:e,month:t,day:n}),r.url="/work_day_entries/"+e+"/"+t+"/"+n+".json",r.fetch()},n}.call(this,Backbone.Router)}}),window.require.define({"views/admin/switch_role":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template=t("../templates/admin/switch_role"),n.prototype.initialize=function(){var e=this;return this.other_roles=this.options.other_roles,this.other_roles.on("reset",function(){return e.render()}),this.view=new i,this.other_roles.on("reset",function(){return e.view.roles(e.other_roles.models)})},n.prototype.render=function(){return $("#modal").html(this.template()).reveal({closed:function(){return $("#modal").html("")}}),$("#modal .close-reveal-modal").click(function(){return $("#modal").trigger("reveal:close")}),ko.applyBindings(this.view,$("#modal")[0]),!1},n}(Backbone.View),i=function(){function e(){var e=this;this.roles=ko.observableArray([]),this.assume_role=function(e){return console.info("Assuming role of "+e.user_name()),e.assume_async({success:function(e){return Backbone.history.fragment=null,Backbone.history.navigate(document.location.hash,!0),window.app.router.current_role.fetch(),$("#modal").trigger("reveal:close")},error:function(e){return console.info("implement me")}})}}return e}()}}),window.require.define({"views/auth/login":function(e,t,n){var r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return this.login=i(this.login,this),this.render=i(this.render,this),n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template=t("../templates/auth/login"),n.prototype.render=function(){var e=this;return $("#main").html(this.template()),$("header.row").html("<h1>Log in</h1><h4>Fill in the form and come aboard!</h4>"),$("#logout, #today, #new_entry, #admin, #this_month").hide(),$("#side").html(""),$(".button.login").click(this.login),$("#user_email").focus(),$("#new_user input").keypress(function(t){if(t.keyCode===13&&!t.shiftKey)return e.login(),!1})},n.prototype.login=function(){var e=this;return $.ajax({url:"/users/sign_in.json",type:"POST",data:{user:{email:$("#user_email").val(),password:$("#user_password").val(),remember_me:1}},success:function(e){return e.success?(humane.log("Welcome aboard!"),$(window).oneTime(500,function(){return Backbone.history.navigate("/#",!0)})):humane.log(e.errors)},error:function(e,t,n){return humane.log(n)}})},n}(Backbone.View)}}),window.require.define({"views/calendar":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t("../lib/string_extensions.js"),n.exports=r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template=t("./templates/calendar/index"),n.prototype.top_tpl=t("./templates/calendar/top"),n.prototype.initialize=function(){var e=this;return this.view=new i(this.options.year,this.options.month),this.collection=this.options.collection,this.collection.on("reset",function(){return e.render(),e.view.days(e.collection.models)}),this.months=this.options.months,this.months.on("reset",function(){return e.view.work_months(e.months.models)})},n.prototype.render=function(){return $(this.el).html(this.template()),$("#side").html(""),$("header.row").html(this.top_tpl()),$("#main").html(this.el),ko.applyBindings(this.view,$("#main")[0]),ko.applyBindings(this.view,$("header.row")[0])},n}(Backbone.View),i=function(){function e(e,t){var n,r,i,s,o,u,a=this;n=moment("2012-11-01"),r=[],this.days=ko.observableArray(r),this.work_months=ko.observableArray([]),this.week_totals=ko.computed(function(){var r,i;return r=_.groupBy(a.days(),function(r){var i;return n=moment.utc(r.get("date")),i=r.week_of_date(n,parseInt(e,10),parseInt(t,10)),i}),i=function(e,t){var n,r,i,s,o,u,a,f;return a=_.map(e.split(" "),function(e){return parseInt(e,10)}),r=a[0],s=a[1],f=_.map(t.split(":"),function(e){return parseInt(e,10)}),n=f[0],i=f[1],u=s+i,o=r+n,u>=60&&(o+=1,u-=60),""+o+"h "+u+"m"},_.map(_.values(r),function(e){return{total:_.reduce(_.map(e,function(e){return e.get("time")}),i,"0h 0m").format_interval(),billable_total:_.reduce(_.map(e,function(e){return e.get("billable_time")}),i,"0h 0m").format_interval(),nonbillable_total:_.reduce(_.map(e,function(e){return e.get("nonbillable_time")}),i,"0h 0m").format_interval(),total_class:function(){var t,r,s,o;return n=moment(e[0].get("date")),n>moment.utc()?"total-notyet":moment.utc(_.last(e).get("date"))>moment.utc()&&n<moment.utc()?"total-thisweek":(s=_.reduce(_.map(e,function(e){return e.get("time")}),i,"0h 0m"),o=s.split(" "),t=o[0],r=o[1],parseInt(t,10)>=40?"total-ok":"total-little")}}})}),this.year=ko.observable(e),this.month=ko.observable(t),i=moment(new Date).year(),this.years=ko.observableArray(function(){u=[];for(var t=2002,n=Math.max(i,parseInt(e));2002<=n?t<=n:t>=n;2002<=n?t++:t--)u.push(t);return u}.apply(this).reverse()),this.months=ko.observableArray($.map(["January","February","March","April","May","June","July","August","September","October","November","December"],function(e,t){return{name:e,value:t+1}})),this.goto=function(e){return Backbone.history.navigate(e.href(),!0)},this.year.subscribe(function(n){if(n.toString()!==e)return Backbone.history.navigate("/#calendar/"+n+"/"+t,!0)}),this.month.subscribe(function(n){if(n.toString()!==t)return Backbone.history.navigate("/#calendar/"+e+"/"+n,!0)}),this.backMonth=function(){return n=moment(),n.year(e),n.month(parseInt(t)-1),n.subtract("months",1),Backbone.history.navigate("/#calendar/"+n.year()+"/"+(n.month()+1),!0)},this.nextMonth=function(){return n=moment(),n.year(e),n.month(parseInt(t)-1),n.add("months",1),Backbone.history.navigate("/#calendar/"+n.year()+"/"+(n.month()+1),!0)}}return e}()}}),window.require.define({"views/entries/edit":function(e,t,n){var r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("models/work_chart"),o=t("collections/work_charts"),r=t("collections/duration_kinds"),n.exports=i=function(e){function n(){return this.render=u(this.render,this),this.set_search=u(this.set_search,this),this.render_charts=u(this.render_charts,this),this.rebuild_charts_array_for=u(this.rebuild_charts_array_for,this),this.handle_quick_pick_option=u(this.handle_quick_pick_option,this),this.render_durations=u(this.render_durations,this),this.render_recents=u(this.render_recents,this),this.render_frequents=u(this.render_frequents,this),this.render_searches=u(this.render_searches,this),this.set_duration_minutes=u(this.set_duration_minutes,this),this.set_duration_hour=u(this.set_duration_hour,this),this.persist=u(this.persist,this),this.back=u(this.back,this),this["delete"]=u(this["delete"],this),n.__super__.constructor.apply(this,arguments)}return f(n,e),n.prototype.template=t("../templates/entries/form"),n.prototype.selects_template=t("../templates/entries/selects"),n.prototype.durations_template=t("../templates/entries/durations"),n.prototype["delete"]=function(){var e,t=this;return confirm("Are you sure you want to delete this entry?")&&(e=moment.utc(this.model.get("date_performed")),$.ajax({url:"/work_entries/"+this.model.get("id"),type:"DELETE",success:function(e){return e.status==="OK"?(humane.log("Entry deleted"),t.back()):humane.log(e.errors)},error:function(e,t,n){return humane.log(n)}})),!1},n.prototype.back=function(){var e,t,n;return n=this.model.get("date_performed"),t=n.length>10?"ddd, YYYY-MM-DD":"YYYY-MM-DD",e=moment.utc(n,t),Backbone.history.navigate("entries/"+e.year()+"/"+(e.month()+1)+"/"+e.date(),!0),$("#modal").trigger("reveal:close")},n.prototype.persist=function(){var e,t,n,r,i,s=this;return this.model.set("work_chart_id",this.selected_chart.get("id"),{silent:!0}),this.model.set("date_performed",$("#work_entry_date_performed").val(),{silent:!0}),this.model.set("description",$("#work_entry_description").val(),{silent:!0}),n=$(".single-duration").map(function(e,t){return{kind_code:$(".kind_code_select",t).val(),duration_hours:$(".hour-select",t).val(),duration_minutes:$(".minutes-select",t).val(),created_by:s.model.get("work_entry_durations")[0].created_by,modified_by:s.model.get("work_entry_durations")[0].created_by,id:s.model.get("work_entry_durations")[e].id}}),this.model.set("work_entry_durations",n.toArray(),{silent:!0}),i=$("#work_entry_work_entry_fees_attributes_0_fee").val(),_.isNaN(parseFloat(i,10))&&(i="0"),r=[{fee:parseFloat(i,10)}],this.model.set("work_entry_fees",r,{silent:!0}),t=moment.utc(this.model.get("date_performed")),e=this.model.toJSON(),e.work_entry_durations_attributes=e.work_entry_durations,delete e.work_entry_durations,e.work_entry_fees_attributes=e.work_entry_fees,delete e.work_entry_fees,$.ajax({url:"/work_entries/"+this.model.get("id"),type:"PUT",data:{work_entry:e},success:function(){return humane.log("Entry saved"),s.back()},error:function(e,t,n){return humane.log(n)}}),!1},n.prototype.initialize=function(){var e=this;return this.model.bind("change",this.render),this.charts=[],this.charts[0]=new o,this.charts[0].on("reset",this.render_charts),this.show_inactive=!1,this.frequents=new o,this.frequents.url="/work_charts/frequent.json",this.frequents.on("reset",this.render_frequents),this.recents=new o,this.recents.url="/work_charts/recent.json",this.recents.on("reset",this.render_recents),this.searches=new o,this.duration_kinds=new r,this.duration_kinds.on("reset",function(){var t,n,r,i,s,o,u,a,f,l;e.render_durations(),t=e.model.get("work_entry_durations"),i=e.duration_kinds.pluck("code");if(e.duration_kinds.size()<t.length)return f=_.filter(t,function(e){return!_.contains(i,e.kind_code)}),t=_.difference(t,f),l=t[0].duration.split(";"),n=l[0],s=l[1],r=_.map(f,function(e){return parseInt(e.duration.split(":")[0],10)}),o=_.map(f,function(e){return parseInt(e.duration.split(":")[1],10)}),u=parseInt(n,10)+_.reduce(r,function(e,t){return e+t},0),a=parseInt(s,10)+_.reduce(o,function(e,t){return e+t},0),t[0].duration=""+u+":"+a+":00",t[0].kind_code=_.first(e.duration_kinds.models).get("code"),e.model.set("work_entry_durations",t,{silent:!0}),e.render_durations()}),this.selected_chart=new s,this.selected_chart.on("change",function(){return e.rebuild_charts_array_for(e.selected_chart),e.duration_kinds.url="/work_charts/"+e.selected_chart.get("id")+"/duration_kinds.json",e.duration_kinds.fetch()})},n.prototype.set_duration_hour=function(e,t){var n,r,i,s,o;return r=this.model.get("work_entry_durations"),n=r[e].duration,o=n.split(":"),s=o[0],i=o[1],r[e].duration=""+t+":"+i+":00",this.model.set("work_entry_durations",r,{silent:!0})},n.prototype.set_duration_minutes=function(e,t){var n,r,i,s,o;return r=this.model.get("work_entry_durations"),n=r[e].duration,o=n.split(":"),i=o[0],s=o[1],r[e].duration=""+i+":"+t+":00",this.model.set("work_entry_durations",r,{silent:!0})},n.prototype.render_searches=function(){var e;return e=this.searches.map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),$(".search-results ul").html(e.join("\n")),$(".search-results ul li").click(this.handle_quick_pick_option)},n.prototype.render_frequents=function(){var e,t,n,r;return e=this.frequents.filter(function(e){return e.get("labels").length>3&&e.get("labels")[1]==="Clients"}),r=this.frequents.filter(function(e){return e.get("labels").length<3||e.get("labels")[1]!=="Clients"}),t=_.sortBy(e,function(e){return e.get("labels")[2]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(2,11).join(" / ")+"</li>"}),n=_.sortBy(r,function(e){return e.get("labels")[1]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),$(".frequent ul.clients").html(t.join("\n")),$(".frequent ul.other").html(n.join("\n")),$(".frequent ul li").click(this.handle_quick_pick_option)},n.prototype.render_recents=function(){var e,t,n,r;return e=this.recents.filter(function(e){return e.get("labels").length>3&&e.get("labels")[1]==="Clients"}),r=this.recents.filter(function(e){return e.get("labels").length<3||e.get("labels")[1]!=="Clients"}),t=_.sortBy(e,function(e){return e.get("labels")[2]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(2,11).join(" / ")+"</li>"}),n=_.sortBy(r,function(e){return e.get("labels")[1]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),$(".recent ul.clients").html(t.join("\n")),$(".recent ul.other").html(n.join("\n")),$(".recent ul li").click(this.handle_quick_pick_option)},n.prototype.render_durations=function(){var e,t=this;return e={work_entry:this.model.toJSON(),duration_kinds:this.duration_kinds.toJSON()},$(".durations").html(this.durations_template(e)),$(".durations .hour-button").click(function(e){var n,r,i,s;return n=$(e.currentTarget),r=$(e.currentTarget).parents(".single-duration"),i=n.attr("data-hour"),$(" .hour-button",r).removeClass("selected"),n.addClass("selected"),$(" .hour-select option",r).attr("selected",""),$(" .hour-select option[value="+i+"]",r).attr("selected","selected"),s=parseInt($(e.currentTarget).attr("data-index"),10),t.set_duration_hour(s,i),!1}),$(" .hour-select").change(function(e){var n,r,i;return r=$(e.currentTarget).val(),n=$(e.currentTarget).parents(".single-duration"),$(" .hour-button",n).removeClass("selected"),$(" .hour-button[data-hour="+r+"]",n).addClass("selected"),i=parseInt($(e.currentTarget).attr("data-index"),10),t.set_duration_hour(i,r),!1}),$(" .minutes-select").change(function(e){var n,r,i;return i=$(e.currentTarget).val(),n=$(e.currentTarget).parents(".single-duration"),$(" .minute-button",n).removeClass("selected"),$(" .minute-button[data-minute="+i+"]",n).addClass("selected"),r=parseInt($(e.currentTarget).attr("data-index"),10),t.set_duration_minutes(r,i)}),$(" .minute-button").click(function(e){var n,r,i,s;return n=$(e.currentTarget),r=$(e.currentTarget).parents(".single-duration"),s=n.attr("data-minute"),$(" .minute-button",r).removeClass("selected"),n.addClass("selected"),$(" .minutes-select option",r).attr("selected",""),$(" .minutes-select option[value="+s+"]",r).attr("selected","selected"),i=parseInt($(e.currentTarget).attr("data-index"),10),t.set_duration_minutes(i,s),!1}),$(" .button.add:not(.disabled)").click(function(){var e,n,r;return e=t.model.get("work_entry_durations"),n=_.last(e),r=n.constructor(),r.duration="00:00:00",r.modified_by=n.modified_by,r.kind_code=_.first(t.duration_kinds.filter(function(t){return!_.include(_.pluck(e,"kind_code"),t.get("code"))})).get("code"),e.push(r),t.model.set("work_entry_durations",e,{silent:!0}),t.render_durations(),!1}),$(".durations .button.remove:not(:disabled)").click(function(e){var n,r;return r=t.model.get("work_entry_durations"),n=$(e.currentTarget).parents(".single-duration").find(".kind_code_select").val(),r=_.filter(r,function(e){return e.kind_code!==n}),t.model.set("work_entry_durations",r,{silent:!0}),t.render_durations(),!1}),$(".durations .kind_code_select").change(function(e){var n,r;return n=t.model.get("work_entry_durations"),r=parseInt($(e.currentTarget).attr("data-index"),10),n[r].kind_code=$(e.currentTarget).val(),t.model.set("work_entry_durations",n,{silent:!0}),t.render_durations(),!1})},n.prototype.handle_quick_pick_option=function(e){var t,n,r=this;return n=$(e.currentTarget).attr("data-id"),t=new s({id:n}),t.bind("change",function(){return r.rebuild_charts_array_for(t)}),t.fetch()},n.prototype.rebuild_charts_array_for=function(e){var t,n=this;return t=function(e){var r;if(e.get("parent_id")===1){n.render_charts();return}return r=new o,n.charts.unshift(r),r.on("reset",function(){var n,i;return n=r.get(e.get("id")),n&&n.set("selected",!0),i=new s({id:e.get("parent_id")}),i.bind("change",function(){return t(i)}),i.fetch()}),r.fetch({data:$.param({parent_id:e.get("parent_id"),include_inactive:!0})})},this.charts=[],t(e)},n.prototype.render_charts=function(){var e,t,n=this;return t=_.last(_.filter(this.charts,function(e){return e.length>0})).find(function(e){return e.get("selected")===!0}),t&&(this.selected_chart.set("id",t.get("id"),{silent:!0}),this.selected_chart.fetch()),e={charts:this.charts.map(function(e){return n.show_inactive?e.toJSON():_.map(e.where({status:"active"}),function(e){return e.toJSON()})}),entry:this.model.toJSON()},$(".chart-selects",this.el).html(this.selects_template(e)),$(".chart-selects select").change(function(e){var t,r,i,s;return s=parseInt($(e.currentTarget).val(),10),r=parseInt($(e.currentTarget).attr("data-level"),10),i=r+1,n.charts=n.charts.slice(0,r+1||9e9),t=n.charts[r].get(s),n.charts[r].each(function(e){return e.set("selected",!1)}),t.set("selected",!0),n.charts[i]=new o,n.charts[i].on("reset",n.render_charts),n.charts[i].fetch({data:$.param({parent_id:s})})})},n.prototype.set_search=function(){var e=this;return $(".charts-search").autocomplete({source:"/work_charts/search"+(this.show_inactive?"_all":""),minLength:2,select:function(t,n){return e.selected_chart.set("id",n.item.id,{silent:!0}),e.selected_chart.fetch(),$(window).oneTime(10,function(){return $(".charts-search").val("")})}})},n.prototype.render=function(){var e=this;return $(this.el).html(this.template(this.model.toJSON())),$("textarea",this.el).autoGrow(),$(".calendar",this.el).datepicker({dateFormat:"DD, yy-mm-dd"}),$(".calendar",this.el).datepicker("setDate",moment.utc(this.model.get("date_performed")).format("dddd, YYYY-MM-DD")),window.app.modal.show({content:this.el,closed:function(){return e.back()}}),ko.applyBindings(this.view,$("#modal")[0]),!1,$(".charts-search").autocomplete({source:"/work_charts/search",minLength:2,select:function(t,n){return e.selected_chart.set("id",n.item.id,{silent:!0}),e.selected_chart.fetch(),$(window).oneTime(10,function(){return $(".charts-search").val("")})}}),this.charts[0].fetch({data:$.param({parent_id:2})}),$(".dropdown",this.el).click(function(t){return $("html").click(function(){return $(".no-hover",e.el).removeClass("shown")}),$(".no-hover",e.el).toggleClass("shown"),t.stopPropagation()}),$(".toggle_charts_filter").click(function(t){var n;return e.show_inactive=!e.show_inactive,e.render_charts(),e.set_search(),n=e.show_inactive?"/show-inactive.png":"/hide-inactive.png",$("#chart_toggle").attr("src",n),!1}),this.frequents.fetch(),this.recents.fetch(),$("input.charts-search",this.el).focus(function(t){return $(".search-results",e.el).show()}),$("input.charts-search",this.el).blur(function(){return $(".search-results",e.el).hide()}),$("input.charts-search",this.el).keyup(function(t){return $("input.charts-search",e.el).stopTime("search"),$("input.charts-search",e.el).oneTime(500,"search",function(){return e.searches.fetch({data:$.param({phrase:$("input.charts-search",e.el).val()})})})}),this.render_durations(),this.selected_chart.set("id",this.model.get("work_chart_id"),{silent:!0}),this.selected_chart.fetch(),$("a.alert",this.el).click(function(t){return e.back(),!1}),$("button[type=submit]",this.el).click(function(t){return e.persist(),t.preventDefault()}),this},n}(Backbone.View)}}),window.require.define({"views/entries/new":function(e,t,n){var r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("models/work_chart"),o=t("collections/work_charts"),r=t("collections/duration_kinds"),n.exports=i=function(e){function n(){return this.render=u(this.render,this),this.set_search=u(this.set_search,this),this.render_charts=u(this.render_charts,this),this.rebuild_charts_array_for=u(this.rebuild_charts_array_for,this),this.handle_quick_pick_option=u(this.handle_quick_pick_option,this),this.render_durations=u(this.render_durations,this),this.render_recents=u(this.render_recents,this),this.render_frequents=u(this.render_frequents,this),this.render_searches=u(this.render_searches,this),this.set_duration_minutes=u(this.set_duration_minutes,this),this.set_duration_hour=u(this.set_duration_hour,this),this.initialize=u(this.initialize,this),this.back=u(this.back,this),this.persist=u(this.persist,this),n.__super__.constructor.apply(this,arguments)}return f(n,e),n.prototype.template=t("../templates/entries/form"),n.prototype.selects_template=t("../templates/entries/selects"),n.prototype.durations_template=t("../templates/entries/durations"),n.prototype.persist=function(){var e,t,n,r,i,s=this;return this.model.set("work_chart_id",this.selected_chart.get("id"),{silent:!0}),this.model.set("date_performed",$("#work_entry_date_performed").val(),{silent:!0}),this.model.set("description",$("#work_entry_description").val(),{silent:!0}),n=$(".single-duration").map(function(e,t){return{kind_code:$(".kind_code_select",t).val(),duration_hours:$(".hour-select",t).val(),duration_minutes:$(".minutes-select",t).val()}}),this.model.set("work_entry_durations",n.toArray(),{silent:!0}),i=$("#work_entry_work_entry_fees_attributes_0_fee").val(),_.isNaN(parseFloat(i,10))&&(i="0"),r=[{fee:parseFloat(i,10)}],this.model.set("work_entry_fees",r,{silent:!0}),t=moment.utc(this.model.get("date_performed")),e=this.model.toJSON(),e.work_entry_durations_attributes=e.work_entry_durations,delete e.work_entry_durations,e.work_entry_fees_attributes=e.work_entry_fees,delete e.work_entry_fees,$.ajax({url:"/work_entries",type:"POST",data:{work_entry:e},success:function(e){return e.status==="OK"?(humane.log("Entry saved"),s.back()):humane.log(e.errors)},error:function(e,t,n){return humane.log(n)}}),!1},n.prototype.back=function(){return Backbone.history.navigate(Backbone.history.fragment.replace("/new",""),!0),$("#modal").trigger("reveal:close")},n.prototype.initialize=function(){var e=this;return this.charts=[],this.charts[0]=new o,this.charts[0].on("reset",this.render_charts),this.show_inactive=!1,this.frequents=new o,this.frequents.url="/work_charts/frequent.json",this.frequents.on("reset",this.render_frequents),this.recents=new o,this.recents.url="/work_charts/recent.json",this.recents.on("reset",this.render_recents),this.searches=new o,this.duration_kinds=new r,this.duration_kinds.on("reset",function(){var t,n,r,i,s,o,u,a,f,l;e.render_durations(),t=e.model.get("work_entry_durations"),i=e.duration_kinds.pluck("code");if(e.duration_kinds.size()<t.length)return f=_.filter(t,function(e){return!_.contains(i,e.kind_code)}),t=_.difference(t,f),l=t[0].duration.split(";"),n=l[0],s=l[1],r=_.map(f,function(e){return parseInt(e.duration.split(":")[0])}),o=_.map(f,function(e){return parseInt(e.duration.split(":")[1])}),u=parseInt(n)+_.reduce(r,function(e,t){return e+t},0),a=parseInt(s)+_.reduce(o,function(e,t){return e+t},0),t[0].duration=""+u+":"+a+":00",t[0].kind_code=_.first(e.duration_kinds.models).get("code"),e.model.set("work_entry_durations",t,{silent:!0}),e.render_durations()}),this.selected_chart=new s,this.selected_chart.on("change",function(){return e.rebuild_charts_array_for(e.selected_chart),e.duration_kinds.url="/work_charts/"+e.selected_chart.get("id")+"/duration_kinds.json",e.duration_kinds.fetch()})},n.prototype.set_duration_hour=function(e,t){var n,r,i,s,o;r=this.model.get("work_entry_durations"),n=r[e].duration;if(n)return o=n.split(":"),s=o[0],i=o[1],r[e].duration=""+t+":"+i+":00",this.model.set("work_entry_durations",r,{silent:!0})},n.prototype.set_duration_minutes=function(e,t){var n,r,i,s,o;r=this.model.get("work_entry_durations"),n=r[e].duration;if(n)return o=n.split(":"),i=o[0],s=o[1],r[e].duration=""+i+":"+t+":00",this.model.set("work_entry_durations",r,{silent:!0})},n.prototype.render_searches=function(){var e;return e=this.searches.map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),$(".search-results ul").html(e.join("\n")),$(".search-results ul li").click(this.handle_quick_pick_option)},n.prototype.render_frequents=function(){var e,t,n,r;return e=this.frequents.filter(function(e){return e.get("labels").length>2&&e.get("labels")[0]==="Clients"}),r=this.frequents.filter(function(e){return e.get("labels").length<2||e.get("labels")[0]!=="Clients"}),t=_.sortBy(e,function(e){return e.get("labels")[1]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),n=_.sortBy(r,function(e){return e.get("labels")[0]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(0,11).join(" / ")+"</li>"}),$(".frequent ul.clients").html(t.join("\n")),$(".frequent ul.other").html(n.join("\n")),$(".frequent ul li").click(this.handle_quick_pick_option)},n.prototype.render_recents=function(){var e,t,n,r;return e=this.recents.filter(function(e){return e.get("labels").length>2&&e.get("labels")[0]==="Clients"}),r=this.recents.filter(function(e){return e.get("labels").length<2||e.get("labels")[0]!=="Clients"}),t=_.sortBy(e,function(e){return e.get("labels")[1]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(1,11).join(" / ")+"</li>"}),n=_.sortBy(r,function(e){return e.get("labels")[0]}).map(function(e){return"<li data-id='"+e.get("id")+"'>"+e.get("labels").slice(0,11).join(" / ")+"</li>"}),$(".recent ul.clients").html(t.join("\n")),$(".recent ul.other").html(n.join("\n")),$(".recent ul li").click(this.handle_quick_pick_option)},n.prototype.render_durations=function(){var e,t=this;return e={work_entry:this.model.toJSON(),duration_kinds:this.duration_kinds.toJSON()},$(".durations").html(this.durations_template(e)),$(".durations .hour-button").click(function(e){var n,r,i,s;return n=$(e.currentTarget),r=$(e.currentTarget).parents(".single-duration"),i=n.attr("data-hour"),$(" .hour-button",r).removeClass("selected"),n.addClass("selected"),$(" .hour-select option",r).attr("selected",""),$(" .hour-select option[value="+i+"]",r).attr("selected","selected"),s=parseInt($(e.currentTarget).attr("data-index")),t.set_duration_hour(s,i),!1}),$(" .hour-select").change(function(e){var n,r,i;return r=$(e.currentTarget).val(),n=$(e.currentTarget).parents(".single-duration"),$(" .hour-button",n).removeClass("selected"),$(" .hour-button[data-hour="+r+"]",n).addClass("selected"),i=parseInt($(e.currentTarget).attr("data-index")),t.set_duration_hour(i,r),!1}),$(" .minutes-select").change(function(e){var n,r,i;return i=$(e.currentTarget).val(),n=$(e.currentTarget).parents(".single-duration"),$(" .minute-button",n).removeClass("selected"),$(" .minute-button[data-minute="+i+"]",n).addClass("selected"),r=parseInt($(e.currentTarget).attr("data-index")),t.set_duration_minutes(r,i)}),$(" .minute-button").click(function(e){var n,r,i,s;return n=$(e.currentTarget),r=$(e.currentTarget).parents(".single-duration"),s=n.attr("data-minute"),$(" .minute-button",r).removeClass("selected"),n.addClass("selected"),$(" .minutes-select option",r).attr("selected",""),$(" .minutes-select option[value="+s+"]",r).attr("selected","selected"),i=parseInt($(e.currentTarget).attr("data-index")),t.set_duration_minutes(i,s),!1}),$(" .button.add:not(.disabled)").click(function(){var e,n,r;return e=t.model.get("work_entry_durations"),n=_.last(e),r=n.constructor(),r.duration="00:00:00",r.modified_by=n.modified_by,r.kind_code=_.first(t.duration_kinds.filter(function(t){return!_.include(_.pluck(e,"kind_code"),t.get("code"))})).get("code"),e.push(r),t.model.set("work_entry_durations",e,{silent:!0}),t.render_durations(),!1}),$(".durations .button.remove:not(:disabled)").click(function(e){var n,r;return r=t.model.get("work_entry_durations"),n=$(e.currentTarget).parents(".single-duration").find(".kind_code_select").val(),r=_.filter(r,function(e){return e.kind_code!==n}),t.model.set("work_entry_durations",r,{silent:!0}),t.render_durations(),!1}),$(".durations .kind_code_select").change(function(e){var n,r;return n=t.model.get("work_entry_durations"),r=parseInt($(e.currentTarget).attr("data-index")),n[r].kind_code=$(e.currentTarget).val(),t.model.set("work_entry_durations",n,{silent:!0}),t.render_durations(),!1})},n.prototype.handle_quick_pick_option=function(e){var t,n,r=this;return n=$(e.currentTarget).attr("data-id"),t=new s({id:n}),t.bind("change",function(){return r.rebuild_charts_array_for(t)}),t.fetch()},n.prototype.rebuild_charts_array_for=function(e){var t,n=this;return t=function(e){var r;if(e.get("parent_id")===1){n.render_charts();return}return r=new o,n.charts.unshift(r),r.on("reset",function(){var n,i;return n=r.get(e.get("id")),n&&n.set("selected",!0),i=new s({id:e.get("parent_id")}),i.bind("change",function(){return t(i)}),i.fetch()}),r.fetch({data:$.param({parent_id:e.get("parent_id"),include_inactive:!0})})},this.charts=[],t(e)},n.prototype.render_charts=function(){var e,t,n=this;return t=_.last(_.filter(this.charts,function(e){return e.length>0})).find(function(e){return e.get("selected")===!0}),t&&(this.selected_chart.set("id",t.get("id"),{silent:!0}),this.selected_chart.fetch()),e={charts:this.charts.map(function(e){return n.show_inactive?e.toJSON():_.map(e.where({status:"active"}),function(e){return e.toJSON()})}),entry:this.model.toJSON()},$(".chart-selects",this.el).html(this.selects_template(e)),$(".chart-selects select").change(function(e){var t,r,i,s;return s=parseInt($(e.currentTarget).val()),r=parseInt($(e.currentTarget).attr("data-level")),i=r+1,n.charts=n.charts.slice(0,r+1||9e9),t=n.charts[r].get(s),n.charts[r].each(function(e){return e.set("selected",!1)}),t.set("selected",!0),n.charts[i]=new o,n.charts[i].on("reset",n.render_charts),n.charts[i].fetch({data:$.param({parent_id:s,include_inactive:!0})})})},n.prototype.set_search=function(){var e=this;return $(".charts-search").autocomplete({source:"/work_charts/search"+(this.show_inactive?"_all":""),minLength:2,select:function(t,n){return e.selected_chart.set("id",n.item.id,{silent:!0}),e.selected_chart.fetch(),$(window).oneTime(10,function(){return $(".charts-search").val("")})}})},n.prototype.render=function(){var e=this;return $(this.el).html(this.template(this.model.toJSON())),window.app.modal.show({content:this.el,closed:function(){return e.back()}}),$("textarea",this.el).autoGrow(),$(".calendar",this.el).datepicker({dateFormat:"DD, yy-mm-dd"}),$(".calendar",this.el).datepicker("setDate",moment.utc(this.model.get("date_performed")).format("dddd, YYYY-MM-DD")),$(".charts-search").autocomplete({source:"/work_charts/search",minLength:2,select:function(t,n){return e.selected_chart.set("id",n.item.id,{silent:!0}),e.selected_chart.fetch(),$(window).oneTime(10,function(){return $(".charts-search").val("")})}}),this.charts[0].fetch({data:$.param({parent_id:2,include_inactive:!0})}),$(".dropdown",this.el).click(function(t){return $("html").click(function(){return $(".no-hover",e.el).removeClass("shown")}),$(".no-hover",e.el).toggleClass("shown"),t.stopPropagation()}),this.frequents.fetch(),this.recents.fetch(),$(".toggle_charts_filter").click(function(t){var n;return e.show_inactive=!e.show_inactive,e.render_charts(),e.set_search(),n=e.show_inactive?"/show-inactive.png":"/hide-inactive.png",$("#chart_toggle").attr("src",n),!1}),$("input.charts-search",this.el).focus(function(t){return $(".search-results",e.el).show()}),$("input.charts-search",this.el).blur(function(){return $(".search-results",e.el).hide()}),$("input.charts-search",this.el).keyup(function(t){return $("input.charts-search",e.el).stopTime("search"),$("input.charts-search",e.el).oneTime(500,"search",function(){return e.searches.fetch({data:$.param({phrase:$("input.charts-search",e.el).val()})})})}),this.render_durations(),this.selected_chart.set("id",this.model.get("work_chart_id"),{silent:!0}),$("a.alert",this.el).click(function(t){return e.back(),!1}),$("button[type=submit]",this.el).click(function(t){return e.persist(),t.preventDefault()}),this},n}(Backbone.View)}}),window.require.define({"views/hello_view":function(e,t,n){var r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return s(n,e),n.prototype.className="hello",n.prototype.template=t("./templates/hello"),n.prototype.render=function(){return this.$el.html(this.template),this},n}(Backbone.View)}}),window.require.define({"views/navigation/top_bar":function(e,t,n){var r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template=t("../templates/navigation/top_bar"),n.prototype.initialize=function(){var e=this;return this.current_role=this.options.role,this.current_role.on("change",function(){return e.render(),ko.applyBindings(e.view,$(".top-bar")[0])}),this.view=new i(this.current_role)},n.prototype.render=function(){if($(".top-bar").html()==="")return $(".top-bar").html(this.template()),$("#today").click(function(){var e;return e=moment(new Date),Backbone.history.navigate("/#entries/"+e.year()+"/"+(e.month()+1)+"/"+e.date(),!0),!1}),$("#this_month").click(function(){var e;return e=moment(new Date),Backbone.history.navigate("/#calendar/"+e.year()+"/"+(e.month()+1),!0),!1}),$("#new_entry").click(function(){var e;return e=moment(new Date),Backbone.history.navigate("/#entries/"+e.year()+"/"+(e.month()+1)+"/"+e.date()+"/new",!0),!1}),$("#logout").click(function(){var e=this;return $.ajax({url:"/users/sign_out",type:"DELETE",success:function(){return humane.log("Goodbye"),$("#logout").hide(),window.router.current_role.clear(),Backbone.history.navigate("/#",!0)},error:function(){return humane.log("Goodbye"),window.app.current_role.clear(),$("#logout").hide(),Backbone.history.navigate("/#",!0)}}),!1})},n}(Backbone.View),i=function(){function e(e){this.current_role=ko.observable(e),this.assume_other=function(){return window.app.router.trigger("admin:assume-other"),!1},this.redirect_to_admin=function(){return window.open("/admin","_blank"),!1},this.redirect_to_reports=function(){return Backbone.history.navigate("/#reports",!0),!1}}return e}()}}),window.require.define({"views/reports":function(e,t,n){var r,i,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n.exports=r=function(e){function n(){return this.initialize=s(this.initialize,this),n.__super__.constructor.apply(this,arguments)}return u(n,e),n.prototype.template=t("./templates/reports/show"),n.prototype.controls_template=t("./templates/reports/controls"),n.prototype.initialize=function(){return this.view=new i(this.options.roles)},n.prototype.render=function(){return $(this.el).html(this.template()),$("#main").html(this.el),$("header").html(this.controls_template()),$(".daterange").daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]}}),ko.applyBindings(this.view,$("header")[0]),ko.applyBindings(this.view,$("#main")[0])},n}(Backbone.View),i=function(){function e(e){var t=this;this.report_types=ko.observableArray([{value:"break",label:"Break",active:!0}]),this.select_type=function(e){var n;return n=_.map(t.report_types(),function(t){return t.active=t.value===e.value,t}),t.report_types([]),t.report_types(n)},this.selected_type=ko.computed(function(){return t.report_types().length===0?"break":_.find(t.report_types(),function(e){return e.active})}),this.display_full=ko.observable(!1),this.printable=ko.observable(!1),this.open_in_new=ko.observable(!1),this.roles=ko.observableArray([]),e.on("reset",function(){return t.roles(e.models),$(window).oneTime(50,function(){return $(".roles select").chosen()})}),this.date_range_string=ko.observable(""),this.generate_report=function(){return $.ajax({url:"/reports/"+t.selected_type().value+".json",data:{start:t.date_start().toDate(),end:t.date_end().toDate(),roles:t.selected_roles()},success:function(e){return t.report_items(e)}})},this.selected_roles=ko.observableArray([]),this.date_range=ko.computed(function(){return t.date_range_string().split(" - ")}),this.date_start=ko.computed(function(){return t.date_range().length===2?moment(t.date_range()[0]):null}),this.date_end=ko.computed(function(){return t.date_range().length===2?moment(t.date_range()[1]):null}),this.report_items=ko.observable(),this.ready_to_generate=ko.computed(function(){return t.date_range_string().trim()!==""&&t.selected_roles().length>0}),this.generate_status_class=ko.computed(function(){return t.ready_to_generate()?"button":"button disabled"})}return e}()}}),window.require.define({"views/templates/admin/switch_role":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('\n<h4>Assume role of other user</h4>\n<ul class="assume-users-list " data-bind="template: {foreach: roles, name: \'role-template\'}">\n</ul>\n<a class="close-reveal-modal">&#215;</a>\n\n<script type="text/html" id="role-template">\n  <li data-bind="text: user_name(), click: $root.assume_role"></li>\n</script>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/auth/login":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<form accept-charset="UTF-8" class="new_user" id="new_user" method="post">\n    <div><label for="user_email">Email</label><br>\n    <input id="user_email" name="user[email]" size="30" type="email" value=""></div>\n\n    <div><label for="user_password">Password</label><br>\n    <input id="user_password" name="user[password]" size="30" type="password"></div>\n\n    <div><a href="#" class="button login">Sign in</a></div>\n</form>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/calendar/index":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<ul id="calendar" data-bind="template: {foreach: days(), name: \'day-template\'}">\n</ul>\n\n<ul id="calendar-week-totals" data-bind="template: {foreach: week_totals(), name: \'week-total-template\'}">\n</ul>\n\n<table cellpadding="0" cellspacing="0" id="calendar-month-totals">\n  <thead>\n    <tr>\n      <th></th>\n      <th>Available</th>\n      <th>Billable </th>\n      <th>Nonbillable </th>\n      <th>Total</th>\n    </tr>\n  </thead>\n  <tbody data-bind="template: {foreach: work_months(), name: \'month-template\'}"></tbody>\n</table>\n\n<script type="text/html" id="day-template">\n  <li data-bind="attr: {class: date_class($root.year(), $root.month()), \'data-href\': href()}, click: $root.goto">\n    <div data-bind="text: day()"></div>\n    <div class="day-totals" data-bind="visible: !(in_future() && get(\'time\') == \'00:00:00\' ) ">\n      <div data-bind="text: time_string()" class="total-all"></div>\n      <div data-bind="text: billable_time_string()" class="sub"></div>\n      <div data-bind="text: nonbillable_time_string()" class="sub nonbillable"></div></div>\n  </li>\n</script>\n\n<script id="week-total-template" type="text/html">\n  <li data-bind="attr: {class: total_class()}">\n    <div class="day-totals">\n      <div data-bind="text: total" class="total-all"></div>\n      <div data-bind="text: billable_total" class="sub"></div>\n      <div data-bind="text: nonbillable_total" class="sub nonbillable"></div>\n    </div>\n  </li>\n</script>\n\n<script type="text/html" id="month-template">\n  <tr >\n    <td><a data-bind="text: month_year_string(), attr: {href: front_url()}"></a></td>\n    <td data-bind="text: available_string()"></td>\n    <td data-bind="text: billable_string()"></td>\n    <td data-bind="text: nonbillable_string()"></td>\n    <td data-bind="text: total_string(), attr: {class: month_class()}"></td>\n  </tr>\n</script>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/calendar/top":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div id="calendar-controls">\n  <a href="#" class="left" data-bind="click: backMonth">&lt;</a>\n  <select id="years" data-bind="template: {name: \'year-option\', foreach: years()}, value: year"></select>\n  <select id="months" data-bind="template: {name: \'month-option\', foreach: months()}, value: month"></select>\n  <a href="#" class="right" data-bind="click: nextMonth">&gt;</a>\n</div>\n\n<script type="text/html" id="year-option">\n  <option data-bind="text: $data, value: $data"></option>\n</script>\n\n<script type="text/html" id="month-option">\n  <option data-bind="text: $data.name, value: $data.value"></option>\n</script>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/entries/durations":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this;t.push('       <div class="actions">\n         <a href="#" class="button add \n'),this.duration_kinds.length<=this.work_entry.work_entry_durations.length&&t.push(" \n  disabled  \n"),t.push(' ">+</a>\n       </div>\n       '),i=0,t.push("\n       "),y=this.work_entry.work_entry_durations;for(l=0,d=y.length;l<d;l++){e=y[l],t.push('\n       <div class="single-duration">\n         <a href="#" class="button alert remove '),t.push(r(i===0?"disabled":"")),t.push(' ">-</a>\n       '),n=e.duration?parseInt(e.duration.split(":")[0],10):0,t.push("\n       "),a=e.duration?parseInt(e.duration.split(":")[1],10):0,t.push('\n       <div class="input interval optional">\n           <label class="interval optional control-label" \n                  for="work_entry_work_entry_durations_attributes_0_duration">Duration</label>      \n         <div class="row collapse complex-input single-select">\n           <div class="five mobile-three columns">\n             <select data-index="'),t.push(r(i)),t.push('" class="hour-select" name="durations[0][hours]">\n               ');for(s=c=1;c<=25;s=++c)t.push("\n                 <option "),s===n&&(t.push(" "),t.push(r("selected='selected'")),t.push(" ")),t.push(' value="'),t.push(r(s)),t.push('">'),t.push(r(s)),t.push("</option>\n               ");t.push('\n             </select>\n           </div>\n           <div class="one mobile-one columns">\n             <span class="postfix">h</span>\n           </div>\n           <div class="five mobile-three columns single-select">\n             <select data-index="'),t.push(r(i)),t.push('" class="minutes-select" name="durations[0][minutes]">\n               ');for(s=h=1;h<=4;s=++h)t.push("\n                 <option \n                   "),15*s===a&&(t.push(" \n                     "),t.push(r("selected='selected'")),t.push(" \n                   ")),t.push(' \n                  value="'),t.push(r(s*15)),t.push('">'),t.push(r((s*15).toString().pad(2))),t.push("</option>\n               ");t.push('\n             </select>\n           </div>\n           <div class="one mobile-one columns">\n             <span class="postfix">m</span>\n           </div>\n         </div>\n         <div class="row collapse hours-minutes">\n           ');for(s=p=1;p<=9;s=++p)t.push('\n             <a href="#" data-index="'),t.push(r(i)),t.push('" data-hour="'),t.push(r(s)),t.push('" \n                class="button hour-button '),s===n&&(t.push(" "),t.push(r("selected")),t.push(" ")),t.push('">\n                '),t.push(r(s)),t.push("\n            </a>\n           ");t.push("\n           <span>&nbsp;</span>         \n           ");for(s=m=1;m<=4;s=++m)t.push('\n             <a href="#" data-index="'),t.push(r(i)),t.push('" data-minute="'),t.push(r(s*15)),t.push('" \n                class="button minute-button '),s*15===a&&(t.push(" "),t.push(r("selected")),t.push(" ")),t.push('">\n                '),t.push(r((s*15).toString().pad(2))),t.push("\n            </a>\n           ");t.push('\n         </div>\n       </div>\n       <div class="input select optional">\n         <select class="select optional kind_code_select" data-index="'),t.push(r(i)),t.push('" data-placeholder="Select kind" \n            id="work_entry_work_entry_durations_attributes_0_kind_code" \n            name="work_entry[work_entry_durations_attributes][0][kind_code]">\n            '),u=_.reject(this.duration_kinds,function(e){return _.contains(_.pluck(b.work_entry.work_entry_durations,"kind_code"),e.code)}),t.push("\n            "),f=_.find(this.duration_kinds,function(t){return t.code===e.kind_code}),t.push("\n            "),f&&u.push(f),t.push("\n            ");for(g=0,v=u.length;g<v;g++)o=u[g],t.push("\n              <option "),o.code===e.kind_code&&t.push(" selected='selected' "),t.push(' value="'),t.push(r(o.code)),t.push('">'),t.push(r(o.display_label)),t.push("</option>\n            ");t.push("\n         </select>\n       </div>\n       </div>\n"),i+=1,t.push("\n     ")}t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/entries/form":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<form accept-charset="UTF-8" action="" class="simple_form edit_work_entry" method="post">\n  <div class="input work_chart_selector optional">\n    <label class="work_chart_selector optional control-label" for="work_entry_work_chart_id">\n      Chart\n      (  )\n    </label>      \n    <div class="row collapse complex-input">\n      <div class="nine mobile-four columns" >\n         <input class="charts-search" type="text" placeholder="Type to search through work charts">\n      </div>\n      <div class="three mobile-three columns qp-block">\n        <div class="small button dropdown">\n          Quick pick\n          <div class="no-hover" style="top: 31px; ">\n            <div class="frequent">\n              <span>Frequent</span>\n              <h4>Clients:</h4>\n              <ul class="clients">\n              </ul>\n              <h4>Other:</h4>\n              <ul class="other"></ul>\n            </div>\n            <div class="recent">\n              <span>Recent</span>\n              <h4>Clients:</h4>\n              <ul class="clients">\n              </ul>\n              <h4>Other:</h4>\n              <ul class="other"></ul>\n            </div>\n          </div>\n        </div>\n      </div>\n    <div class="row collapse complex-input">\n\n      <div class="chart-selects nine mobile-three columns">\n         <input type="hidden" name="work_entry[work_chart_id]" value="'),t.push(r(this.work_chart_id)),t.push('" >\n         <select name="work_entry[work_chart_id]_" >\n         </select>\n      </div>\n\n      <div class="three columns">\n	 <a href="#" class="toggle_charts_filter" ><img id=\'chart_toggle\' src="/hide-inactive.png" /></a>\n	  </div>\n\n    </div>\n    <div class="row collapse complex-input">\n     <div class="input string optional five columns">\n      <label class="string optional control-label" for="work_entry_date_performed">Date performed</label>\n      <input class="string optional calendar" id="work_entry_date_performed" \n             name="work_entry[date_performed]" size="50" type="text" \n             value="'),t.push(r(this.date_performed)),t.push('">\n     </div>\n     <div class="currency optional five columns">\n      <label class="currency optional control-label"\n             for="work_entry_work_entry_fees_attributes_0_fee">\n             Fee\n      </label>\n      <div class="row collapse complex-input fees-input">\n        <div class="two mobile-one columns">\n          <span class="prefix">$</span>\n        </div>\n        <div class="ten mobile-one columns">\n          <input class="currency optional" id="work_entry_work_entry_fees_attributes_0_fee"\n                 name="work_entry[work_entry_fees_attributes][0][fee]" size="30"\n                 type="text" value="'),this.work_entry_fees.length>0&&t.push(r(this.work_entry_fees[0].fee)),t.push('" >\n        </div>\n      </div>\n\n     </div>\n     <div class="two columns">\n        <div class="six columns">\n		  <div class="small-buttons">\n			<a href="/#'),t.push(r(Backbone.history.fragment.replace("/new",""))),t.push('" class="button alert" ><img src="/delete-vivid.png" /></a>\n		  </div>\n		</div>\n        <div class="six columns">\n		  <div class="small-buttons">\n			<button class="button" type="submit"><img src="/tick-vivid.png" /></button>\n		  </div>\n		</div>\n     </div>\n\n    </div>\n\n\n\n\n    <div class="input">\n     <fieldset class="durations">\n     \n     </fieldset>\n\n     <div class="input text optional">\n       <label class="text optional control-label" for="work_entry_description">Description</label>\n       <textarea class="text optional" cols="40" id="work_entry_description" \n                 name="work_entry[description]" rows="3" >'),t.push(r(this.description)),t.push('</textarea>\n     </div>\n\n\n     <div class="panel input">\n       <div class="four columns">\n	 <a href="/#'),t.push(r(Backbone.history.fragment.replace("/new",""))),t.push('" class="button alert" ><img src="/delete-vivid.png" />Cancel</a>\n       </div>\n       <div class="one columns">\n       </div>\n       <div class="seven columns">\n	 <button class="button" type="submit"><img src="/tick-vivid.png" />Save</button>\n       </div>\n       <div class="clearfix"></div>\n     </div>\n</div>\n\n</form>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/entries/selects":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l;t.push('<input type="hidden" name="work_entry[work_chart_id]" value="'),t.push(r(this.entry.work_chart_id)),t.push('" >\n\n'),n=0,t.push("\n"),l=this.charts;for(o=0,a=l.length;o<a;o++){s=l[o],t.push("\n\n  ");if(s.length>0){t.push('\n    <select data-level="'),t.push(r(n)),t.push('" name="work_entry[work_chart_id]_" >\n      <option></option>\n      '),i=0,t.push("\n      ");for(u=0,f=s.length;u<f;u++)e=s[u],t.push("\n        <option "),e.selected===!0&&t.push("selected='selected'"),t.push(' value="'),t.push(r(e.id)),t.push('">'),t.push(r(e.display_label)),t.push("</option>\n      ");t.push("\n    </select>\n    "),i+=1,t.push("\n  ")}t.push("\n  "),n+=1,t.push("\n")}t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/hello":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push(r("Hello!!")),t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/navigation/top_bar":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<ul>\n  <li class="name">\n  <a href="/#" style="visibility: visible;"><b>End Point&nbsp;</b><span>App</span>\n  </a>\n  </li>\n  <li class="divider"></li>\n  <li>\n    <a href="#" id="this_month">\n      <img src="/calendar-white.png" />\n      Calendar\n    </a>\n  </li>\n  <li class="divider"></li>\n  <li>\n  <a href="#" id="today"><img src="/notes-white.png" />Today</a>\n  </li>\n  <li class="divider"></li>\n  <li>\n  <a href="#" id="new_entry"><img src="/compose-white.png" />New entry</a>\n  </li>\n  <li class="toggle-topbar"><a href="#"></a></li>\n</ul>\n<section>\n  <ul class="left"></ul>\n  <ul class="right">\n    <li class="divider" ></li>\n    <li class="has-dropdown"  >\n    <a href="#">Settings</a>\n      <ul class="dropdown">\n        <li><a data-bind="click: redirect_to_reports" href="#">Reports</a></li>\n        <li data-bind="if: current_role().get(\'can_switch_roles\')">\n        <a id="assume-other" data-bind="click: assume_other" href="#"><img src="/swap-white.png" />Switch role</a>\n        </li>\n        <li data-bind="if: current_role().get(\'is_admin\')">\n        <a href="#" data-bind="click: redirect_to_admin" ><img src="/settings-white.png" />Admin</a>\n        </li>\n      </ul>\n    </li>\n    <li class="divider"></li>\n    <li>\n      <span data-bind="text: current_role().get(\'email\')"></span>\n      <i data-bind="visible: current_role().assumed_other()">as</i>\n      <i data-bind="text: current_role().as_label()"></i>\n    </li>\n    <li>\n    <a href="#" id="logout">Logout</a>\n    </li>\n  </ul>\n</section>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/reports/controls":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<dl class="sub-nav reports">\n  <dt>Report type:</dt>\n  <!-- ko foreach: report_types -->\n    <dd data-bind="attr: {class: active ? \'active\' : \'\'}">\n      <a href="#" data-bind="text: label, click: $root.select_type"></a>\n    </dd>\n  <!-- /ko -->\n</dl>\n<form action="#" class="custom report-controls">\n  <a href="#" data-bind="click: generate_report, attr: {class: generate_status_class}">Generate</a>\n  <input type="text" placeholder="Pick date range" data-bind="value: date_range_string, valueUpdate: \'blur\'" class="daterange reports" />\n  <label class="roles">\n    <select data-bind="foreach: roles, selectedOptions: selected_roles" data-customforms="disabled" \n            class="chosen" data-placeholder="Choose roles" multiple>\n      <option data-bind="value: get(\'email\'), text: user_name()"></option>\n    </select>\n  </label>\n<!--  <div class="report-options">\n    <label>\n      <input type="checkbox" data-bind="checked: display_full" style="display: none;">\n      <span class="custom checkbox"></span> Display full descriptions\n    </label>\n    <label>\n      <input type="checkbox" data-bind="checked: printable" style="display: none;">\n      <span class="custom checkbox"></span> Printable\n    </label>\n    <label>\n      <input type="checkbox" data-bind="checked: open_in_new" style="display: none">\n      <span class="custom checkbox"></span> Open in new window\n    </label>\n  </div> -->\n</form>\n\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/reports/show":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="report_content" data-bind="template: {name: $root.selected_type().value}"></div>\n\n<script id="break" type="text/html">\n  <ul data-bind="template: {name: \'report_item\', foreach: report_items}"></ul>\n</script>\n\n<script id="user" type="text/html"></script>\n\n<script id="category" type="text/html"></script>\n\n<script id="report_item" type="text/html">\n  <li>\n    <span class="name" data-bind="text: name"></span>\n    <span class="total" data-bind="text: total"></span> \n    <ul data-bind="template: {name: \'report_item\', foreach: children}"></ul>\n  </li>\n</script>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/work_day/show":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<table cellspacing="0" class="work_day_table">\n  <col><col><col><col>\n  <tbody data-bind="template: {name: \'entry_template\', foreach: collection}">\n  </tbody>\n</table>\n<div class="actions">\n  <a data-bind="click: redirect_to_new" class="button"><img src="/compose-vivid.png" />New entry</a>\n</div>\n\n<script id="middle_label_template" type="text/x-jquery-tmpl">\n<br>\n    <span data-bind="text: $data"></span>\n</script>\n\n<script id="entry_template" type="text/x-jquery-tmpl">\n<tr>\n    <td>\n      <span data-bind="text: top_label(), visible: chart_has_many_labels()"></span>\n      <span data-bind="template: {name: \'middle_label_template\', foreach: middle_labels()}, visible: chart_has_many_labels()">\n      </span>\n      <br data-bind="visible: chart_has_many_labels()">\n      \n      <b data-bind="text: last_label()"></b>\n    </td>\n    <td>\n      <div data-bind="text: time_string()"></div>\n      <div class="entry_fee" data-bind="text: fee_total_string(), visible: fee_not_empty()"></div>\n    </td>\n    <td class="entry-description" data-bind="html: get(\'description\')"></td>\n    <td>\n      <a data-bind="click: $root.redirect_to_entry" href="#">Edit</a>\n      <ul class="nav-bar">\n        <li class="has-flyout">\n          <a href="#" data-bind="click: $root.entry_settings"><img src="/settings-darkgray.png" /></a>\n          <a href="#" class="flyout-toggle"><span></span></a>\n          <ul class="flyout right">\n            <li><img src="/delete-darkgray.png" /><a data-bind="click: $root.delete_entry" href="#">Delete</a></li>\n          </ul>\n        </li>\n      </ul>\n      <br>\n    </td>\n  </tr>\n</script>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/templates/work_day/totals":function(e,t,n){n.exports=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="">\n  <table class="day_totals">\n    <tr>\n      <td>Billable:</td>\n      <td data-bind="text: billable"></td>\n    </tr>\n    <tr>\n      <td>Non-billable:</td>\n      <td data-bind="text: nonbillable"></td>\n    </tr>\n    <tr>\n      <td><b>Total:</b></td>\n      <td><b data-bind="text: total"></b></td>\n    </tr>\n  </table>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}}),window.require.define({"views/work_day":function(e,t,n){var r,i,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t("lib/backbone_extensions.js"),n.exports=r=function(e){function n(){return this.render=s(this.render,this),n.__super__.constructor.apply(this,arguments)}return u(n,e),n.prototype.template=t("./templates/work_day/show"),n.prototype.totals_tpl=t("./templates/work_day/totals"),n.prototype.initialize=function(){var e=this;return this.view=new i(this.options.year,this.options.month,this.options.day),this.collection=this.options.collection,this.collection.on("reset",function(){return e.render(),e.collection.each(function(t){return e.view.collection.push(t)}),ko.applyBindings(e.view,$("#main")[0]),ko.applyBindings(e.view,$("#side")[0])})},n.prototype.render=function(){return $("#main").html(this.template()),$("header.row").html("<h1>Work entries for "+this.view.day.format("dddd, MMM Do YYYY")+"</h1><h4>Take a peek at what you've accomplished</h4>"),$("#side").html(this.totals_tpl()),$(window).oneTime(100,function(){return $(document).foundationNavigation()})},n}(Backbone.View),i=function(){function e(e,t,n){this.new_url=s(this.new_url,this),this.redirect_to_new=s(this.redirect_to_new,this);var r=this;this.collection=ko.observableArray(),this.billable=ko.computed(function(){var e,t;return e=_.reduce(r.collection(),function(e,t){return e+t.billable_hours()},0),t=_.reduce(r.collection(),function(e,t){return e+t.billable_minutes()},0),moment.utc("00:00:00","HH:mm:ss").add("hours",e).add("minutes",t).format("HH:mm").format_interval()}),this.nonbillable=ko.computed(function(){var e,t;return e=_.reduce(r.collection(),function(e,t){return e+t.nonbillable_hours()},0),t=_.reduce(r.collection(),function(e,t){return e+t.nonbillable_minutes()},0),moment.utc("00:00:00","HH:mm:ss").add("hours",e).add("minutes",t).format("HH:mm").format_interval()}),this.total=ko.computed(function(){var e,t;return e=_.reduce(r.collection(),function(e,t){return e+parseInt(t.hours(),10)},0),t=_.reduce(r.collection(),function(e,t){return e+parseInt(t.minutes(),10)},0),moment.utc("00:00:00","HH:mm:ss").add("hours",e).add("minutes",t).format("HH:mm").format_interval()}),this.day=moment.utc([e,t-1,n]),this.collection.removeAll(),this.redirect_to_entry=function(e){return window.app.router.navigate(e.front_url(),{trigger:!0}),!1},this.delete_entry=function(e){if(confirm("Do you really want to remove work entry?"))return e.delete_async({success:function(){return humane.log("Work entry successfully deleted"),Backbone.history.refresh()},error:function(e){return humane.error("Error: "+e)}})},this.entry_settings=function(e){return!1},this}return e.prototype.redirect_to_new=function(){return window.app.router.navigate(this.new_url(),{trigger:!0})},e.prototype.new_url=function(){return"/#entries/"+this.day.year()+"/"+(this.day.month()+1)+"/"+this.day.date()+"/new"},e}()}})